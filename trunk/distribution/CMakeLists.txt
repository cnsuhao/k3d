# Setup some odds-and-ends used for distribution
SET(K3D_SVN_ROOT "https://k3d.svn.sourceforge.net:/svnroot/k3d")
SET(K3D_SVN_TRUNK "${K3D_SVN_ROOT}/trunk")
SET(K3D_SVN_TAGS "${K3D_SVN_ROOT}/tags")
SET(K3D_SVN_BRANCHES "${K3D_SVN_ROOT}/branches")
SET(K3D_BRANCH_TAG "k3d-release-${MAJOR_VERSION}.${MINOR_VERSION}")
SET(K3D_VERSION_TAG "k3d-${MAJOR_VERSION}.${MINOR_VERSION}.${RELEASE_VERSION}.${BUILD_VERSION}")

ADD_CUSTOM_TARGET(changelog
	COMMAND ${SVNCOMMAND} log > ${k3d_BINARY_DIR}/ChangeLog
	WORKING_DIRECTORY ${k3d_SOURCE_DIR}
	)

ADD_CUSTOM_TARGET(tag-trunk
	COMMAND ${SVNCOMMAND} cp ${K3D_SVN_TRUNK} ${K3D_SVN_TAGS}/${K3D_VERSION_TAG} -m "COMP: Tagged K-3D Version ${VERSION}"
	WORKING_DIRECTORY ${k3d_SOURCE_DIR}
	)

ADD_CUSTOM_TARGET(tag-branch
	COMMAND ${SVNCOMMAND} cp ${K3D_SVN_TRUNK} ${K3D_SVN_BRANCHES}/${K3D_BRANCH_TAG} -m "COMP: Branched K-3D Version ${VERSION}"
	WORKING_DIRECTORY ${k3d_SOURCE_DIR}
	)

IF(K3D_BUILD_INSTALLER)
	# Setup default packaging parameters ...
	SET(CPACK_PACKAGE_DESCRIPTION "K-3D free-as-in-freedom modeling, animation and rendering system")
	SET(CPACK_PACKAGE_EXECUTABLES "k3d;K-3D ${VERSION}")
	SET(CPACK_PACKAGE_FILE_NAME "k3d-setup-${VERSION}")
	SET(CPACK_PACKAGE_INSTALL_DIRECTORY "K-3D ${VERSION}")
	SET(CPACK_PACKAGE_INSTALL_REGISTRY_KEY "K-3D ${VERSION}")
	SET(CPACK_PACKAGE_NAME "k3d")
	SET(CPACK_PACKAGE_VENDOR "www.k-3d.org")
	SET(CPACK_PACKAGE_VERSION ${VERSION})
	SET(CPACK_PACKAGE_VERSION_MAJOR ${MAJOR_VERSION})
	SET(CPACK_PACKAGE_VERSION_MINOR ${MINOR_VERSION})
	SET(CPACK_PACKAGE_VERSION_PATCH ${RELEASE_VERSION})
	SET(CPACK_RESOURCE_FILE_LICENSE "${k3d_SOURCE_DIR}/COPYING")
	SET(CPACK_SOURCE_GENERATOR "TGZ;TBZ2")
	SET(CPACK_SOURCE_PACKAGE_FILE_NAME "k3d-source-${VERSION}")

	IF(APPLE)
		ADD_SUBDIRECTORY(osx)
	ENDIF(APPLE)

	IF(UNIX AND NOT APPLE)
		ADD_SUBDIRECTORY(posix)
	ENDIF(UNIX AND NOT APPLE)

	IF(WIN32)
		ADD_SUBDIRECTORY(win32)
	ENDIF(WIN32)

ENDIF(K3D_BUILD_INSTALLER)
