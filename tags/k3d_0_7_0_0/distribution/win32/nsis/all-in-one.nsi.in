SetCompressor /SOLID lzma

!define PRODUCT_NAME "@CPACK_PACKAGE_NAME@"
!define PRODUCT_VERSION "@CPACK_PACKAGE_VERSION@"
!define PRODUCT_PUBLISHER "@CPACK_PACKAGE_VENDOR@"
!define PRODUCT_WEB_SITE "http://www.k-3d.org"

; MUI Settings
!include "MUI.nsh"
!define MUI_ABORTWARNING
!define MUI_ICON "${NSISDIR}\Contrib\Graphics\Icons\modern-install.ico"
!define MUI_UNICON "${NSISDIR}\Contrib\Graphics\Icons\modern-uninstall.ico"

!insertmacro MUI_PAGE_WELCOME
!insertmacro MUI_PAGE_DIRECTORY
!insertmacro MUI_PAGE_INSTFILES
!insertmacro MUI_PAGE_FINISH
!insertmacro MUI_LANGUAGE "English"

Name "${PRODUCT_NAME} ${PRODUCT_VERSION}"
OutFile "k3d-all-in-one-setup-${PRODUCT_VERSION}.exe"
InstallDir "C:\k3d"
ShowInstDetails show
ShowUnInstDetails show

VIAddVersionKey "ProductName" "${PRODUCT_NAME}"
VIAddVersionKey "LegalCopyright" "@COPYRIGHT@"
VIAddVersionKey "FileDescription" "${PRODUCT_NAME} ${PRODUCT_VERSION} Installer"
VIAddVersionKey "FileVersion" "${PRODUCT_VERSION}"
VIProductVersion "${PRODUCT_VERSION}"

Section "MainSection" SEC01
  SetOverwrite try

  SetOutPath "$INSTDIR"
  File "@K3D_K3D_INSTALLER_DIR@\@K3D_K3D_INSTALLER@"
  File "@K3D_AQSIS_INSTALLER_DIR@\@K3D_AQSIS_INSTALLER@"
  File "@K3D_PYTHON_INSTALLER_DIR@\@K3D_PYTHON_INSTALLER@"
  File "@K3D_PYGTK_INSTALLER_DIR@\@K3D_PYGTK_INSTALLER@"
  File "@K3D_PYCAIRO_INSTALLER_DIR@\@K3D_PYCAIRO_INSTALLER@"
  File "@K3D_CGKIT_INSTALLER_DIR@\@K3D_CGKIT_INSTALLER@"

  ExecWait "@K3D_AQSIS_INSTALLER@"
  ExecWait "msiexec.exe /i @K3D_PYTHON_INSTALLER@"
  ExecWait "@K3D_PYGTK_INSTALLER@"
  ExecWait "@K3D_PYCAIRO_INSTALLER@"
  ExecWait "@K3D_CGKIT_INSTALLER@"
  ExecWait "@K3D_K3D_INSTALLER@"

  Delete "$INSTDIR\@K3D_K3D_INSTALLER@"
  Delete "$INSTDIR\@K3D_AQSIS_INSTALLER@"
  Delete "$INSTDIR\@K3D_PYTHON_INSTALLER@"
  Delete "$INSTDIR\@K3D_PYGTK_INSTALLER@"
  Delete "$INSTDIR\@K3D_PYCAIRO_INSTALLER@"
  Delete "$INSTDIR\@K3D_CGKIT_INSTALLER@"

SectionEnd

